# Generated by BehavEd
# ( "have all three puzzles been solved?" )
puz_status = getGameFlag("bonus5", 1 )
if puz_status == 1
     # ( "since the three puzzles have been solved..." )
     # ( "...the torch should be as the player left it" )
     killEntitySilent("sun_pillar" )
     actSilent("fx_torch03_beam", "fx_torch03_beam" )
     actSilent("fx_torch03", "fx_torch03" )
     actSilent("light_torch03", "light_torch03" )
else
     # ( "since the 3 puzzles have not been solved..." )
     # ( "...the player should see the torch light" )
     # ( "====================" )
     # ( "lock controls" )
     lockControls(-1.000 )
     setallaiactive("FALSE" )
     # ( "move camera and turn on beam" )
     cameraFocusToEntity("fx_torch03_beam", 384.000, 45.000, 270.000, 2.000 )
     cameraShake(1.000, 2.500 )
     sound (  "PLAY_SOUND", "zone_shared/fx/screen_shake", "", "" )
     waittimed ( 2.500 )
     act("fx_torch03_beam", "fx_torch03_beam" )
     act("fx_stone", "fx_stone" )
     sound (  "PLAY_SOUND", "zone_shared/special/avalanche", "", "" )
     act("fx_dust01", "fx_dust01" )
     act("fx_dust02", "fx_dust02" )
     waittimed ( 2.000 )
     # ( "move camera and light torch" )
     cameraFocusToEntity("fx_torch03", 384.000, 45.000, 315.000, 3.000 )
     waittimed ( 3.500 )
     act("fx_torch03", "fx_torch03" )
     sound (  "PLAY_SOUND", "zone_shared/fx/fire_burst", "", "" )
     act("light_torch03", "light_torch03" )
     waittimed ( 2.000 )
     # ( "is this the last of the three torches?" )
     setGameFlag("bonus5", 13, 1 )
     puzzle = getGameFlag("bonus5", 11 )
     if puzzle == 1
          # ( "kf -- finished [11]. if you've finished [12], too, then set [14] to indicate" )
          # ( "that all three are finished" )
          puzzle = getGameFlag("bonus5", 12 )
          if puzzle == 1
               # ( "kf -- finished [12] and finished[13] as well as [11]. set [14] cuz we're all done" )
               setGameFlag("bonus5", 14, 1 )
          endif
     endif
     # ( "kf -- bonus5[14] is true if whole thing is complete" )
     complete = getGameFlag("bonus5", 14 )
     if complete == 1
          # ( "indicate all 3 puzzles are solved" )
          setGameFlag("bonus5", 1, 1 )
          # ( "move camera" )
          cameraFocusToEntity("pit", 512.000, 45.000, 315.000, 2.000 )
          waittimed ( 2.500 )
          # ( "open the doors of the pit" )
          act("pit", "pit" )
          act("spwnr_tony", "spwnr_tony" )
          waittimed ( 1.000 )
          # ( "raise the floor and bring tony" )
          act("rising_floor", "rising_floor" )
          waittimed ( 3.000 )
          # ( "fade out and reset camera" )
          cameraFade(1.000, 0.500 )
          waittimed ( 0.500 )
          cameraReset( )
          # ( "fade in and unlock controls" )
          cameraFade(0.000, 1.000 )
          waittimed ( 1.000 )
          lockControls(0.100 )
          setallaiactive("TRUE" )
     else
          # ( "this is not the last of the three torches" )
          # ( "fade out and reset camera" )
          cameraFade(1.000, 0.500 )
          waittimed ( 0.500 )
          cameraReset( )
          # ( "fade in and unlock controls" )
          cameraFade(0.000, 1.000 )
          waittimed ( 1.000 )
          lockControls(0.100 )
          setallaiactive("TRUE" )
     endif
endif

